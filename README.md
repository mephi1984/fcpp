# Дипломный проект «Поисковая система»

* [Рекомендации по работе над дипломом](#Рекомендации-по-работе-над-дипломом).
* [Описание](#описание).
* [Поисковая система](#поисковая-система):
    * [программа «индексатор»](##Программа-«Индексатор»),
    * [индексация](##индексация),
    * [параметры индексации](##Параметры-индексации),
    * [программа-поисковик](#программа-поисковик),
    * [база данных](#база-данных),
    * [файл конфигурации ini](#файл-конфигурации-ini).
* [Что является итогом работы](#что-является-итогом-работы).
* [Критерии оценки](#критерии-оценки).
* [Полезные материалы](#полезные-материалы).
* [Как задавать вопросы руководителю по дипломной работе](#как-задавать-вопросы-руководителю-по-дипломной-работе).

---
# Рекомендации по работе над дипломом

1. Не откладывайте надолго начало работы над дипломом. В таком случае у вас останется больше времени на получение рекомендаций от руководителя и доработку.
2. Разбейте работу над дипломом на части. Выполняйте их поочерёдно. Вы будете успевать учитывать комментарии от руководителя и не терять мотивацию на полпути.
3. Сдавайте работу на проверку частями. Не ждите, когда выполните всё задание полностью.
---

# Описание
Необходимо написать поисковую систему, которая выполняет поиск среди текстовых документов в файловой системе.

Поисковая система будет получать данные из текстовых файлов, строить поисковые индексы и по запросу выдавать релевантные результаты поисковой выдачи.

Поисковая система будет состоять из следующих частей:
* программа «Индексатор». Это программа, задача которого — парсить текстовые файлы в файловой системе и строить индексы исходя из частоты слов в документах;
* программа-поисковик. Это программа, задача которой — принимать запросы и возвращать результаты поиска.

Для хранения информации следует использовать базу данных PostgreSQL.

Настройки программ следует хранить в ini-файле конфигурации.

# Поисковая система
## Программа «Индексатор»
Если в файловой системе слишком много текстовых файлов, то каждый поисковый запрос занимает много времени. Чтобы решить эту проблему, использвается программа «Индексатор». Эта программа запускается и заранее анализирует файлы в файловой системе, собирая информацию о том, какие слова встречаются в каких файлах.

## Индексация
Программа «Индексатор» при запуске получает название каталога (папки) в файловой системе, в котором нужно выполнить индексацию. Дальше эта программа переходит от файла к файлу, загружая текстовое содержимое этого файла. Программа «Индексатор» должна обходить каталог (папку) рекурсивно - это значит, что если в каталоге есть другие каталоги, то программа должна проанализировать файлы и в этих каталогах. Если в этих каталогах тоже есть другие каталоги - нужно проиндексировать файлы и там тоже, и так далее.

Индексатор выполняет следующие действия для каждого текстового файла:
* текст очищается от знаков препинания, табуляции, переносов строк и т. д. Остаются только слова, разделённые пробелами;
* слова переводятся в нижний регистр — для этого вы можете использовать библиотеку [Boost Locale](https://www.boost.org/doc/libs/1_82_0/libs/locale/doc/html/index.html). Для простоты можно также отбрасывать все слова короче трёх или длиннее 32 символов;
* анализируется частотность слов в тексте. Программа считает, сколько раз встречается каждое слово в тексте;
* информация о словах и о частотности сохраняется в базу данных.

Для хранения информации о частотности слов рекомендуется использовать две таблицы — «Документы» и «Слова» — и реализовать между ними связь «многие-ко-многим» с помощью промежуточной таблицы. В эту же промежуточную таблицу будет записана частота использования слова в документе. Однако конечное решение о том, как хранить данные в базе и какая будет структура базы данных, должны принять вы.

Для того, чтобы программа «Индексатор» работала достаточно быстро, следует распараллелить обработку файлов между несколькими потоками. Вам нужно создать пул потоков, и распределять задачи по обработке файлов между потоками. Таким образом вы можете обрабатывать несколько файлов одновременно. Вам нужно обеспечить синхронизацию данных, и вы должны написать код так, чтобы избежать состояний, таких как deadlock или состояние гонки.

## Параметры индексации
В ini-файле конфигурации задаются параметры работы программы «Индексатор», а именно:
 - С какого каталога следует начать индексацию документов. Это должна быть строка, например "C:\Work\Documents"
 - Какие расширения файлов следует учитывать. Это должна быть строка, в которой записаны расширения файлов, разделенных запятой, например "txt,md,ini,csv"

## Программа-поисковик
Программа-поисковик выполняет поиск по базе данных, ранжирует результат и возвращает его пользователю. В настоящих поисковых системах ранжирование выполняется по множеству критериев, однако для простоты будем ранжировать страницу по частоте упоминания искомых слов в документе.

Изнутри поисковик представляет из себя консольную программу. При запуске программа показывает поле для ввода, в которое нужно ввести поисковый запрос в виде списка слов разделенных пробелами. Например: «‎привет мир».

После того как пользователь введет свой запрос нажмет ENTER происходит извлечение из базы данных результата запроса и его ранжирование, а затем на экран выводится отсортированный список из результатов поиска.

Для простоты запрос можно анализировать только в виде слов, разделённых пробелами. Все прочие знаки препинания игнорируются. Можно также ограничить длину запроса — не более четырёх слов. 

Для извлечения данных напишите SQL-запрос. Запрос должен быть следующим: взять документы, в которых встречаются все слова из запроса, и отсортировать их по суммарному количеству упоминаний слов в документе.

Приведём пример для запроса «‎привет мир». Предположим, если в документе A слово «‎привет» встречается 10 раз, а слово «‎мир» четыре раза, то этот документ имеет релевантность 10 + 4 = 14. Если в документе B слово «‎привет» встречается три раза, а слово «‎мир» восемь раз, то релевантность его равна 3 + 8 = 11, и он будет находиться ниже в выдаче.

Для простоты можете ограничить выдачу, выдавая не более чем 10 результатов поиска.

После выполнения запроса программа должна вывести на экран результаты поиска — названия файлов, в которых содержатся запрашиваемые слова. Результаты должны быть отсортированы по убыванию.

В случае если результатов не найдено, на экране следует отобразить соответствующее сообщение.

В случае если при работе программы возникла ошибка, на экране также следует отобразить сообщение о внутренней ошибке.

При желании, можно сделать эту программу в виду HTTP сервера или в виде GUI-приложения, но это необязательно. Достаточно будет написать просто консольную программу с полем для ввода.

## База данных
Для выполнения задания рекомендуется использовать базу данных PostgreSQL.

Для подключения к базе данных рекомендуется использовать библиотеку `libpqxx`.

Настройки базы данных (хост, порт, название БД, имя пользователя, пароль) следует хранить в ini-файле конфигурации.

При первом запуске программы «‎Паук» следует выполнить создание таблиц базы данных, используя запрос `CREATE TABLE IF NOT EXISTS`.

## Файл конфигурации ini
Все настройки программ следует хранить в ini-файле. Этот файл должен парситься при запуске вашей программы.

В этом файле следует хранить следующие параметры:
* хост (адрес) базы данных;
* порт, на котором запущена база данных;
* название базы данных;
* имя пользователя для подключения к базе данных;
* пароль пользователя для подключения к базе данных;
* стартовый каталог (папка) для программы «‎Индексатор»;
* список расширений файлов, для программы «‎Индексатор»;

# Что является итогом работы
1. Репозиторий на GitHub с исходным кодом вашего проекта и ini-файлом конфигурации.

# Критерии оценки
1. Выполнены минимальные требования к работе.
2. Приложение полностью функционирует: нет логически недоделанных частей, заглушек, TODO и т. д.
3. Нет явных изъянов в архитектуре, «плохо пахнущего кода», проблем с многопоточностью, утечек памяти, неотловленных исключений и т. д.

---

# Как задавать вопросы руководителю по дипломной работе

1. Если у вас возник вопрос, попробуйте сначала самостоятельно найти ответ в интернете. Навык поиска информации пригодится вам в любой профессиональной деятельности. Если ответ не нашёлся, можно уточнить у руководителя по дипломной работе.
2. Если у вас набирается несколько вопросов, присылайте их в виде нумерованного списка. Так дипломному руководителю будет проще отвечать на каждый из них.
3. Для лучшего понимания контекста прикрепите к вопросу скриншоты и стрелкой укажите, что именно вызывает затруднения. Программу для создания скриншотов можно скачать [по ссылке](https://app.prntscr.com/ru/).
4. По возможности задавайте вопросы в комментариях к коду.
5. Формулируйте свои вопросы чётко, дополняя их деталями. На сообщения «Ничего не работает», «Всё сломалось» дипломный руководитель не сможет дать комментарии без дополнительных уточнений. Это затянет процесс получения ответа. 
6. Постарайтесь набраться терпения в ожидании ответа на свои вопросы. Дипломные руководители Нетологии — практикующие разработчики, поэтому они не всегда могут отвечать моментально. Зато их практика даёт возможность делиться с вами не только теорией, но и ценным прикладным опытом.  

Успешной работы!
